<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Klubbregistrering / Club Registration</title>
  <link rel="icon" href="/thai_gala_mobile_site/logo_design.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@600;700;800&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <!-- Version stamp: v-register-match-landing-1 -->
  <style>
    :root{
      /* Dark arena gradient palette (matching landing) */
      --bg-grad-start:#0d1629;
      --bg-grad-end:#1b2e45;
      --grain:rgba(255,255,255,0.03);
      --card:#f9fafb; /* white card */
      --card-border:#dce3ec;
      --text:#0f172a;
      --muted:#5f6e80;
      /* CTA reds (same as landing) */
      --accent-red:#ff3131;
      --accent-red-glow:rgba(255,49,49,0.45);
      --accent-red-mid:#ff4232;
      --accent-red-hot:#ff5d3a;
      --accent-red-edge:#ff7845;
      /* Language pills */
      --lang-bg:#111418;
      --lang-bg-hover:#1d242c;
      --lang-active-outline:#ef233c;
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{
      margin:0;display:flex;align-items:center;justify-content:center;padding:1.6rem;
      background:
        radial-gradient(1200px 800px at 20% 12%, rgba(19,34,53,0.45) 0%, rgba(19,34,53,0.12) 44%, rgba(10,15,31,0) 64%),
        radial-gradient(1100px 760px at 82% 88%, rgba(12,20,36,0.50) 0%, rgba(10,15,31,0.22) 56%, rgba(10,15,31,0) 72%),
        linear-gradient(135deg, var(--bg-grad-start) 0%, #162a44 38%, #1f3b57 70%, var(--bg-grad-end) 100%);
      position:relative;font-family:'Montserrat','Poppins','Bebas Neue',Arial,sans-serif;color:var(--text);
    }
    /* Gritty noise + vignette */
    body::before{content:'';position:absolute;inset:0;pointer-events:none;background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>");background-size:160px 160px;background-repeat:repeat;mix-blend-mode:overlay;opacity:.10;filter:contrast(118%)}
    body::after{content:'';position:absolute;inset:0;pointer-events:none;background:radial-gradient(120% 90% at 50% 30%, rgba(0,0,0,0) 60%, rgba(0,0,0,0.28) 100%)}

    /* Logo top-left */
    .site-logo{position:absolute;top:18px;left:24px;width:140px;max-width:30vw;height:auto;z-index:40;display:block;filter:drop-shadow(0 4px 10px rgba(0,0,0,0.38));transition:transform .3s ease,filter .3s ease}
    .site-logo:hover{transform:scale(1.05);filter:drop-shadow(0 6px 14px rgba(0,0,0,0.5))}
    @media (max-width:640px){.site-logo{width:110px;left:16px;top:16px}}

    /* White content card */
    .card{background:var(--card);border:1px solid var(--card-border);border-radius:18px;box-shadow:0 18px 40px -10px rgba(0,0,0,0.35),0 6px 18px rgba(0,0,0,0.20);width:min(960px,95vw);padding:1.4rem 1.6rem;position:relative}
    header{padding:.2rem 0 1rem}
    .hero{display:flex;flex-direction:column;gap:1.4rem;padding-bottom:1rem}
    .hero-list-row{display:flex;align-items:flex-start;gap:.5rem}
    .hero-text-icon{width:38px;max-width:8vw;height:auto;flex-shrink:0;margin:-4px 0 0;filter:drop-shadow(0 3px 6px rgba(0,0,0,0.1))}
    .hero-copy{display:flex;flex-direction:column;gap:.6rem}
    h1{margin:0;font-weight:800;font-size:clamp(2rem,6vw,2.8rem);letter-spacing:0;text-transform:uppercase;font-family:'Bebas Neue','Montserrat',sans-serif;color:#08111c}
    .hero-list{list-style:none;margin:.4rem 0 1.2rem;padding:0;display:flex;flex-direction:column;gap:.65rem}
    .hero-list li{position:relative;padding-left:0;font-size:1.08rem;font-weight:800;letter-spacing:-.04rem;color:#0f172a;line-height:1.18}
    .cta{appearance:none;border:0;padding:1rem 2.6rem;border-radius:999px;font-size:clamp(1.05rem,3vw,1.15rem);font-weight:800;letter-spacing:.04rem;text-transform:none;color:#fff;cursor:pointer;background:linear-gradient(120deg,#ff3a2f 0%,#ff4a33 55%,#ff4a33 100%);box-shadow:0 10px 32px -12px rgba(255,70,70,0.65);transition:transform .2s ease,box-shadow .2s ease,filter .2s ease}
    .cta:hover{transform:translateY(-2px);box-shadow:0 16px 36px -14px rgba(255,70,70,0.65);filter:brightness(1.03)}
    .cta:active{transform:translateY(1px)}
    .hero-side{display:flex;flex-direction:column;gap:1.1rem;align-items:flex-start}
    .info-btn{appearance:none;border:0;border-radius:999px;padding:.95rem 1.9rem;font-size:1rem;font-weight:700;color:#f5f7ff;background:linear-gradient(145deg,#0c2750,#0f3668);box-shadow:0 12px 30px -12px rgba(7,22,48,.9);cursor:pointer;align-self:flex-start;transition:transform .2s ease,box-shadow .2s ease,filter .2s ease}
    .hero-info{margin-top:.4rem}
    .info-btn:hover{transform:translateY(-1px);box-shadow:0 16px 36px -14px rgba(7,22,48,.9);filter:brightness(1.03)}
    .info-btn:active{transform:translateY(1px)}
    @media (min-width:720px){
      .hero{flex-direction:row;justify-content:space-between;align-items:center}
      .hero-copy{flex:2}
      .hero-side{flex:1;align-items:flex-start}
    }

    /* Language pills styled like landing */
    .panel-top{display:flex;justify-content:flex-end;margin-bottom:.4rem}
    .lang-switch{display:flex;flex-wrap:wrap;gap:.55rem}
    .lang-switch button{background:var(--lang-bg);color:#e5e9ef;border:1px solid rgba(255,255,255,0.08);padding:.55rem 1.05rem;border-radius:999px;cursor:pointer;font-weight:600;font-size:.9rem;letter-spacing:.4px;font-family:'Montserrat',sans-serif;display:inline-flex;align-items:center;gap:.4rem;transition:background .25s ease,box-shadow .25s ease,color .25s ease}
    .lang-switch button:hover{background:var(--lang-bg-hover)}
    .lang-switch button.active{box-shadow:0 0 0 2px var(--lang-active-outline),0 6px 16px -4px rgba(239,35,60,0.4)}

    /* Form layout in a clean, bright style */
    form{padding:.6rem 0 0;display:flex;flex-direction:column;gap:1.25rem}
    .box-group{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.0rem}
    .cta-lower{display:flex;justify-content:center;padding:.4rem 0 0}
    .field-box{position:relative;background:#fff;border:1px solid var(--card-border);border-radius:14px;padding:.9rem .95rem;display:flex;flex-direction:column;gap:.6rem;min-height:132px;box-shadow:0 4px 14px -10px rgba(0,0,0,.12)}
    .field-box:hover{border-color:#cfd8e3}
    .field-box label{font-weight:700;font-size:.78rem;letter-spacing:.5px;text-transform:uppercase;color:#4b5563}
    input[type="text"],input[type="email"],input[type="url"],input[type="file"]{padding:.7rem .85rem;font-size:1rem;border-radius:10px;border:1px solid #ccd6e2;background:#ffffff;color:var(--text);box-shadow:0 1px 1px rgba(0,0,0,.04) inset}
    input:focus{outline:2px solid #ef233c;outline-offset:2px}

    .success{display:none;margin:0;padding:1rem 1.35rem;border-radius:999px;background:linear-gradient(145deg,#0c2750,#0f3668);color:#f5f7ff;font-weight:700;border:1px solid rgba(12,39,80,0.65);box-shadow:0 18px 38px -16px rgba(7,22,48,0.85),0 8px 26px -18px rgba(15,54,104,0.7);align-items:center;gap:.65rem;letter-spacing:.16px;font-size:.95rem;line-height:1.2;display:flex;font-family:'Montserrat','Poppins','Bebas Neue',Arial,sans-serif;flex-wrap:wrap}
    .success::before{content:'✔';font-size:1.05rem;color:#0f3668;background:#f5f7ff;width:30px;height:30px;border-radius:10px;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 18px -10px rgba(255,255,255,0.5)}
    .success a{color:#8bd4ff;font-weight:700;text-decoration-color:rgba(139,212,255,0.45);text-underline-offset:3px}
    .success a:hover{color:#d7f0ff;text-decoration-color:currentColor}
    .success .qr-link{background:rgba(255,255,255,0.14);color:#f5f7ff;border:1px solid rgba(255,255,255,0.35);border-radius:999px;padding:.3rem .85rem;font-size:.86rem;font-weight:700;text-decoration:none;display:inline-flex;align-items:center;gap:.35rem;margin-left:.35rem;transition:background .25s ease,box-shadow .25s ease,transform .15s ease;border:none;cursor:pointer;font-family:'Montserrat','Poppins','Bebas Neue',Arial,sans-serif}
    .success .qr-link:hover{background:rgba(255,255,255,0.28);box-shadow:0 6px 18px -10px rgba(255,255,255,0.65);transform:translateY(-1px)}

      /* Demo modal (copied from create.html for consistent styling) */
      .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;padding:1rem;z-index:1000}
      .modal-backdrop[aria-hidden="false"]{display:flex}
      .modal-content{border-radius:12px;box-shadow:0 22px 60px rgba(0,0,0,0.55),0 6px 24px -8px rgba(0,0,0,0.5);max-width:min(96vw,1000px);width:100%;max-height:90vh;position:relative;overflow:hidden;
        background:
          radial-gradient(900px 600px at 18% 14%, rgba(19,34,53,0.55) 0%, rgba(19,34,53,0.18) 44%, rgba(10,15,31,0) 70%),
          radial-gradient(1000px 640px at 82% 86%, rgba(12,20,36,0.55) 0%, rgba(10,15,31,0.25) 56%, rgba(10,15,31,0) 78%),
          linear-gradient(135deg, var(--bg-grad-start) 0%, #162a44 38%, #1f3b57 70%, var(--bg-grad-end) 100%);
        backdrop-filter:blur(4px)}
      .modal-content::before{content:"";position:absolute;inset:0;pointer-events:none;background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>");background-size:160px 160px;mix-blend-mode:overlay;opacity:.12;filter:contrast(120%)}
      .modal-inner{max-height:90vh;overflow:auto;padding:0}
      .modal-inner img,.modal-inner object{display:block;width:100%;height:auto}
      .modal-close{position:absolute;top:8px;right:8px;width:36px;height:36px;border:none;border-radius:999px;background:rgba(0,0,0,0.65);color:#fff;font-size:22px;line-height:1;cursor:pointer}
      .modal-close:hover{background:rgba(0,0,0,0.8)}
    .qr-modal .modal-inner{padding:1.6rem;display:flex;flex-direction:column;align-items:center;gap:1rem}
    #qrCodeImg{width:230px;height:230px;object-fit:contain;border-radius:16px;background:#fff;padding:.6rem;box-shadow:0 18px 46px -20px rgba(0,0,0,0.65)}
    #qrHint{margin:0;color:#cfd8ee;font-size:.88rem;font-weight:600;text-align:center}
    /* Logo drop zone inside white card */
    /* Redesigned logo drop area */
    .logo-zone{position:relative;background:linear-gradient(135deg,#f9fbfd 0%,#eef3f8 55%,#e6edf5 100%);border:2px dashed #c2d1e1;border-radius:16px;min-height:200px;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1.2rem .9rem;gap:.85rem;cursor:pointer;transition:border-color .25s ease, background .35s ease, box-shadow .35s ease}
    .logo-zone:hover{border-color:#b2c2d4;box-shadow:0 10px 28px -8px rgba(0,0,0,.18)}
    .logo-zone.drag{border-color:#ef233c;background:linear-gradient(135deg,#f4f7fa,#e9f0f7);box-shadow:0 0 0 4px rgba(239,35,60,.15)}
    .logo-zone input{display:none}
    .logo-empty-icon{width:58px;height:58px;display:block;opacity:.85;filter:drop-shadow(0 3px 6px rgba(0,0,0,.15))}
    .logo-prompt{margin:0;font-weight:700;font-size:.9rem;letter-spacing:.4px;color:#0f172a;text-align:center}
    .logo-prompt .action{display:inline-block;margin-left:.35rem;padding:.4rem .85rem;border-radius:999px;background:#ef233c;color:#fff;font-size:.72rem;font-weight:700;letter-spacing:.5px;text-decoration:none;box-shadow:0 6px 18px -6px rgba(239,35,60,.5);transition:filter .25s ease, box-shadow .25s ease}
    .logo-prompt .action:hover{filter:brightness(1.06);box-shadow:0 8px 22px -6px rgba(239,35,60,.55)}
    .logo-hint{color:#6b7280;font-size:.7rem;margin:0;font-weight:600;letter-spacing:.3px}
    .logo-preview{max-width:160px;max-height:110px;border-radius:12px;box-shadow:0 6px 18px -8px rgba(0,0,0,.28);display:none;background:#fff;object-fit:contain;padding:.4rem;border:1px solid #d4dde7}
    .logo-info{display:none;flex-direction:column;align-items:center;gap:.35rem;font-size:.7rem;color:#475569;font-weight:600}
    .logo-remove{display:none;position:absolute;top:10px;right:10px;background:#fff;border:1px solid #d3dde9;border-radius:8px;padding:.35rem .55rem;font-size:.65rem;font-weight:700;color:#0f172a;cursor:pointer;line-height:1;display:flex;align-items:center;gap:.35rem;box-shadow:0 4px 14px -6px rgba(0,0,0,.18);transition:background .25s ease,filter .25s ease}
    .logo-remove svg{width:14px;height:14px;stroke:#dc2626;stroke-width:2;fill:none}
    .logo-remove:hover{filter:brightness(.95)}
    .logo-zone.has-file{border-style:solid;border-color:#d1dae5}
    .logo-zone.has-file:hover{box-shadow:0 12px 30px -10px rgba(0,0,0,.22)}

    @media (max-width:640px){
      .card{padding:1rem 1.1rem;border-radius:16px}
      h1{font-size:clamp(1.6rem,7vw,2rem)}
      .box-group{gap:.85rem}
      .hero-list-row{flex-direction:column;gap:.4rem}
      .hero-text-icon{width:30px;margin:-2px 0 0}
    }
  </style>
</head>
<body>
  <img src="thai_gala_mobile_site/logo_design.svg" alt="Logo" class="site-logo" />
  <main class="card" aria-live="polite" role="region" aria-label="Club registration">
    <div class="panel-top">
      <div class="lang-switch" aria-label="Språk / Language">
        <button type="button" data-lang="sv">Svenska</button>
        <button type="button" data-lang="en">English</button>
        <button type="button" data-lang="th">ไทย</button>
      </div>
    </div>
    <header class="hero">
      <div class="hero-copy">
        <h1 id="heroTitle">Create your fightcard here!</h1>
        <div class="hero-list-row">
          <img src="text.svg" alt="Checklist" class="hero-text-icon" />
          <ul class="hero-list">
            <li id="heroBullet1">CREATE BEAUTIFUL FIGHT CARDS FOR YOUR COMBAT SPORTS EVENTS INSTANTLY!</li>
            <li id="heroBullet2">UPDATE MATCHES LIVE AND SHARE EVERYTHING WITH THE AUDIENCE AND CLUBS.</li>
          </ul>
        </div>
        <button type="button" class="info-btn hero-info" id="heroInfoBtn" data-target="/#how-it-works">How does it work?</button>
      </div>
    </header>

    <form id="clubForm" novalidate>
      <div class="success" id="successMsg">Tack! Sparat lokalt – fortsätt.</div>
      <div class="box-group">
        <div class="field-box" id="boxEmail">
          <label id="lblEmail">E‑postadress</label>
          <input type="email" name="email" placeholder="namn@klubb.se" autocomplete="email" required />
        </div>
        <div class="field-box" id="boxClub">
          <label id="lblClub">Klubbnamn</label>
          <input type="text" name="club" placeholder="Loyalty Muay Thai" required />
        </div>
      </div>
      <div class="cta-lower">
        <button type="submit" class="cta" id="heroCta">Save &amp; continue</button>
      </div>
    </form>

  </main>

  <!-- Demo SVG Modal -->
  <div id="demoModal" class="modal-backdrop" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Demo">
    <div class="modal-content">
      <button type="button" class="modal-close" aria-label="Close demo">&times;</button>
      <div class="modal-inner">
        <img id="demoSvg" src="demo.svg" alt="Demo fight card" />
      </div>
    </div>
  </div>

  <!-- QR Modal -->
  <div id="qrModal" class="modal-backdrop" aria-hidden="true" role="dialog" aria-modal="true" aria-label="QR code viewer">
    <div class="modal-content qr-modal">
      <button type="button" class="modal-close" aria-label="Close QR">&times;</button>
      <div class="modal-inner">
        <img id="qrCodeImg" alt="QR code" />
        <p id="qrHint">Skanna koden för att öppna fightcard.</p>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const dict = {
        sv:{ heroTitle:'SKAPA DITT FIGHTCARD HÄR!', bullet1:'SKAPA SNYGGA FIGHTCARDS FÖR DINA KAMPSPORTSEVENT DIREKT!', bullet2:'UPPDATERA MATCHER LIVE OCH DELA ALLT MED PUBLIK OCH KLUBBAR.', cta:'Spara & fortsätt', info:'Hur funkar det?', email:'E‑postadress', club:'Klubbnamn', ok:'Tack! Sparat lokalt – fortsätt.', linkPrefix:'Länk skapad', viewLink:'visa fightcard', adminLink:'öppna admin', linkFail:'Kunde inte skapa länk (servern måste vara igång på http://localhost:3000).', qrLink:'visa QR-kod', qrAlt:'QR-kod för fightcard', qrHint:'Skanna koden för att öppna fightcard.' },
        en:{ heroTitle:'CREATE YOUR FIGHTCARD HERE!', bullet1:'CREATE BEAUTIFUL FIGHT CARDS FOR YOUR COMBAT SPORTS EVENTS INSTANTLY!', bullet2:'UPDATE MATCHES LIVE AND SHARE EVERYTHING WITH THE AUDIENCE AND CLUBS.', cta:'Save & continue', info:'How does it work?', email:'Email address', club:'Club name', ok:'Saved locally – continue.', linkPrefix:'Link ready', viewLink:'view fightcard', adminLink:'open admin', linkFail:'Could not create link (server must be running at http://localhost:3000).', qrLink:'view QR code', qrAlt:'QR code for fightcard', qrHint:'Scan this code to open the fightcard.' },
        th:{ heroTitle:'สร้างไฟต์การ์ดของคุณที่นี่!', bullet1:'สร้างไฟต์การ์ดสุดสวยสำหรับงานกีฬาต่อสู้ของคุณได้ทันที', bullet2:'อัปเดตผลการแข่งขันสดและแชร์ให้ผู้ชมและสโมสรได้ทันที', cta:'บันทึกและไปต่อ', info:'มันทำงานอย่างไร?', email:'อีเมล', club:'ชื่อสโมสร', ok:'บันทึกแล้ว – ไปต่อ.', linkPrefix:'สร้างลิงก์แล้ว', viewLink:'ดูไฟต์การ์ด', adminLink:'เปิดแอดมิน', linkFail:'ไม่สามารถสร้างลิงก์ได้ (ต้องเปิดเซิร์ฟเวอร์ที่ http://localhost:3000).', qrLink:'ดูคิวอาร์โค้ด', qrAlt:'คิวอาร์โค้ดสำหรับไฟต์การ์ด', qrHint:'สแกนโค้ดนี้เพื่อเปิดไฟต์การ์ด' }
      };
      const qs = new URLSearchParams(location.search);
      let lang = (qs.get('lang')||navigator.language||'sv').toLowerCase();
      if (lang.startsWith('en')) lang='en'; else if (lang.startsWith('th')) lang='th'; else lang='sv';
      try{ const stored = localStorage.getItem('lf_lang'); if(stored) lang = stored; }catch(e){}

      const qrModal = document.getElementById('qrModal');
      const qrImg = document.getElementById('qrCodeImg');
      const qrHintEl = document.getElementById('qrHint');
      const qrCloseBtn = qrModal ? qrModal.querySelector('.modal-close') : null;
      let lastViewerUrl = '';

      function apply(l){
        const d = dict[l] || dict.sv; lang = l;
        const setText = (id,val)=>{ const el=document.getElementById(id); if(el) el.textContent = val; };
        setText('heroTitle', d.heroTitle);
        setText('heroBullet1', d.bullet1);
        setText('heroBullet2', d.bullet2);
        setText('lblEmail', d.email);
        setText('lblClub', d.club);
        setText('heroCta', d.cta);
        setText('heroInfoBtn', d.info);
        setText('successMsg', d.ok);
        if (qrHintEl) qrHintEl.textContent = d.qrHint;
        if (qrImg) qrImg.alt = d.qrAlt;
        document.querySelectorAll('.lang-switch button').forEach(b=> b.classList.toggle('active', b.dataset.lang===l));
        document.documentElement.lang = l;
        try{ localStorage.setItem('lf_lang', l); }catch(e){}

        const demoImgEl = document.getElementById('demoSvg');
        if (demoImgEl){
          const nextSrc = (l === 'sv') ? 'demo_swe.svg' : (l === 'th') ? 'demo_thai.svg' : 'demo.svg';
          if (demoImgEl.getAttribute('src') !== nextSrc){
            demoImgEl.setAttribute('src', nextSrc);
          }
          if (l === 'sv'){ demoImgEl.setAttribute('alt','Exempel på svenskt fightcard demo'); }
          else if (l === 'th'){ demoImgEl.setAttribute('alt','ตัวอย่างเดโมไฟต์การ์ด'); }
          else { demoImgEl.setAttribute('alt','Demo fight card example'); }
        }
      }

      function openQrModal(){
        if (!qrModal || !qrImg || !lastViewerUrl) return;
        const qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=' + encodeURIComponent(lastViewerUrl);
        qrImg.src = qrUrl;
        qrModal.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
      }

      function closeQrModal(){
        if (!qrModal) return;
        qrModal.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
      }

      function wireQrLink(container){
        if (!container) return;
        const trigger = container.querySelector('.qr-link');
        if (trigger){
          trigger.addEventListener('click', (ev)=>{
            ev.preventDefault();
            if (!lastViewerUrl) return;
            openQrModal();
          });
        }
      }

      const form = document.getElementById('clubForm');
      document.querySelectorAll('.lang-switch button').forEach(b=> b.addEventListener('click', ()=> apply(b.dataset.lang)));

      const demoModal = document.getElementById('demoModal');
      const modalCloseBtn = demoModal ? demoModal.querySelector('.modal-close') : null;
      function openDemoModal(){
        if (!demoModal) return;
        demoModal.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
      }
      function closeDemoModal(){
        if (!demoModal) return;
        demoModal.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
      }

      const heroInfoBtn = document.getElementById('heroInfoBtn');
      if (heroInfoBtn){
        heroInfoBtn.addEventListener('click', (ev)=>{
          ev.preventDefault();
          openDemoModal();
        });
      }
      if (modalCloseBtn){
        modalCloseBtn.addEventListener('click', closeDemoModal);
      }
      if (demoModal){
        demoModal.addEventListener('click', (ev)=>{ if (ev.target === demoModal) closeDemoModal(); });
      }
      if (qrCloseBtn) qrCloseBtn.addEventListener('click', closeQrModal);
      if (qrModal){
        qrModal.addEventListener('click', (ev)=>{ if (ev.target === qrModal) closeQrModal(); });
      }
      window.addEventListener('keydown', (ev)=>{
        if (ev.key === 'Escape'){
          if (demoModal && demoModal.getAttribute('aria-hidden') === 'false') closeDemoModal();
          if (qrModal && qrModal.getAttribute('aria-hidden') === 'false') closeQrModal();
        }
      });

      // Choose API base: if page is served by the Node server (port 3000), use relative; otherwise use http://localhost:3000
      const API_BASE = (/(:|\/)3000$/.test(location.origin) ? '' : 'http://localhost:3000');
      const zone = document.getElementById('logoZone');
      const input = document.getElementById('logoInput');
      const preview = document.getElementById('logoPreview');
      const removeBtn = document.getElementById('removeLogo');
      const emptyIcon = document.querySelector('.logo-empty-icon');
      const info = document.getElementById('logoInfo');
      if (zone && input && preview && removeBtn){
        function setLogo(file){
          if (!file) return;
          const url = URL.createObjectURL(file);
          preview.src = url; preview.style.display='block';
          removeBtn.style.display='flex';
          zone.classList.add('has-file');
          zone.classList.remove('drag');
          if (emptyIcon) emptyIcon.style.display='none';
          if (info){
            info.style.display='flex';
            info.innerHTML = `<span>${file.name}</span><span>${(file.size/1024).toFixed(1)} KB</span>`;
          }
          try{ localStorage.setItem('lf_logo_name', file.name); }catch(e){}
        }
        function bindPickLink(){
          const link = document.getElementById('logoPickLink');
          if(link){ link.addEventListener('click', (ev)=>{ ev.preventDefault(); input.click(); }); }
        }
        zone.addEventListener('click', (ev)=>{ if(ev.target.id==='logoPickLink' || ev.target.closest('.action')) return; input.click(); });
        zone.addEventListener('keydown', (e)=>{ if (e.key==='Enter' || e.key===' ') { e.preventDefault(); input.click(); } });
        input.addEventListener('change', (e)=>{ const f = e.target.files && e.target.files[0]; if (f) setLogo(f); });
        ;['dragenter','dragover'].forEach(ev=> zone.addEventListener(ev, e=>{ e.preventDefault(); e.stopPropagation(); zone.classList.add('drag'); }));
        ;['dragleave','drop'].forEach(ev=> zone.addEventListener(ev, e=>{ e.preventDefault(); e.stopPropagation(); if(ev==='drop'){ const f = e.dataTransfer.files && e.dataTransfer.files[0]; if (f){ input.files = e.dataTransfer.files; setLogo(f); } } zone.classList.remove('drag'); }));
        removeBtn.addEventListener('click', (ev)=>{
          ev.stopPropagation();
          preview.src=''; preview.style.display='none'; input.value=''; removeBtn.style.display='none';
          if (info){ info.style.display='none'; info.innerHTML=''; }
          if (emptyIcon) emptyIcon.style.display='block';
          zone.classList.remove('has-file');
          try{ localStorage.removeItem('lf_logo_name'); localStorage.removeItem('lf_logo_data'); }catch(e){}
        });
        try{
          const prevData = localStorage.getItem('lf_logo_data');
          if (prevData){
            preview.src = prevData; preview.style.display='block'; removeBtn.style.display='flex';
            zone.classList.add('has-file'); if (emptyIcon) emptyIcon.style.display='none';
          }
        }catch(e){}
        document.addEventListener('click', (e)=>{ if(e.target && e.target.id==='logoPickLink'){ e.preventDefault(); input.click(); }});
        bindPickLink();
      }

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const fd = new FormData(form);
        const data = Object.fromEntries(fd.entries());
        if (data.logo instanceof File){
          data.logoName = data.logo.name;
          try{
            const reader = new FileReader();
            reader.onload = () => { try{ localStorage.setItem('lf_logo_data', reader.result); }catch(e){} };
            reader.readAsDataURL(data.logo);
          }catch(e){}
          delete data.logo;
        }
        try{ localStorage.setItem('lf_club', JSON.stringify(data)); }catch(err){ console.warn('localStorage save failed', err); }
        // Create unique card on the server (default TTL 48h)
        const msg = document.getElementById('successMsg');
        try{
          const resp = await fetch(API_BASE + '/cards', { method:'POST', headers:{ 'Content-Type':'application/json' }, body: JSON.stringify({ ttlHours: 48, club: data, useClubSlug: true }) });
          if(!resp.ok) throw new Error('Create failed: '+resp.status);
          const out = await resp.json();
          const viewer = (API_BASE? API_BASE: '') + out.viewerUrl;
          const admin = (API_BASE? API_BASE: '') + out.adminUrl;
          const strings = dict[lang] || dict.sv;
          lastViewerUrl = viewer;
          // Show links without auto redirect
          msg.innerHTML = `${strings.linkPrefix} · <a href="${viewer}" target="_blank" rel="noopener">${strings.viewLink}</a> · <a href="${admin}" target="_blank" rel="noopener">${strings.adminLink}</a> · <button type="button" class="qr-link">${strings.qrLink}</button>`;
          msg.style.display='flex';
          wireQrLink(msg);
          // Removed automatic redirect; user stays on this page and can choose links manually.
        }catch(err){
          console.warn(err);
          const strings = dict[lang] || dict.sv;
          lastViewerUrl = '';
          msg.textContent = strings.linkFail;
          msg.style.display='flex';
        }
      });
      const demoImg = document.getElementById('demoSvg');
      function markMissingDemo(){
        if (!demoImg) return;
        const pane = document.createElement('div');
        pane.style.padding = '2rem';
        pane.style.color = '#fff';
        pane.style.font = '600 1rem Montserrat, sans-serif';
        pane.style.textAlign = 'center';
        pane.textContent = 'Demo SVG not found or empty. Please provide demo.svg.';
        demoImg.replaceWith(pane);
      }
      if (demoImg){
        demoImg.addEventListener('error', markMissingDemo);
        demoImg.addEventListener('load', ()=>{
          if (demoImg.naturalWidth === 0 || demoImg.naturalHeight === 0){
            markMissingDemo();
          }
        });
      }

      apply(lang);
    })();
  </script>
</body>
</html>
